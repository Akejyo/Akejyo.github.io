---
title: "Treewidth 7.1"
date: 2022-12-18
tags:
  - Parameterized Algorithms
---

Trees, narrow grids, and dynamic programming

<!-- more -->

# Treewidth 7.1

â€‹	è¯¥èŠ‚æ˜¯ç”±**æ ‘å½¢DP**çš„ä¸€ä¸ªç»å…¸[é¢˜ç›®](https://oi-wiki.org/dp/tree/)å»¶ä¼¸è€Œæ¥ã€‚ç»™ä½ ä¸€ä¸ªæ ‘ï¼ŒèŠ‚ç‚¹æœ‰æƒå€¼ï¼Œå½“ä½ é€‰æ‹©ä¸€ä¸ªèŠ‚ç‚¹åï¼Œä½ è·å¾—è¯¥ç‚¹çš„æƒå€¼ä½†å…¶ç›¸é‚»èŠ‚ç‚¹ä¸èƒ½è¢«é€‰ï¼Œé—®èƒ½è·å¾—åˆ°çš„æœ€å¤§æƒå€¼ã€‚

> We shall call this problem **Weighted Independent Set.**

â€‹	ç”±äºæ ‘çš„ç»“æ„ç‰¹æ€§ï¼Œä¸Šè¿°é—®é¢˜å¯ä»¥ä¸€é $dfs$ è·‘æ‰ï¼Œå…·ä½“å¯ä»¥ç‚¹ä¸Šé¢çš„é“¾æ¥æŸ¥çœ‹ã€‚

â€‹	é‚£ä¹ˆï¼Œä¸æ˜¯æ ‘çš„æƒ…å†µçš„è¯¥æ€ä¹ˆè§£å†³å‘¢ï¼Ÿæœ¬èŠ‚é‡Œä»‹ç»äº†ç½‘æ ¼å›¾çš„è§£å†³æ–¹æ¡ˆï¼Œæ›´å…·ä½“ä¸€ç‚¹ï¼Œæ˜¯"narrow grids"çš„å­å›¾ã€‚

> Since the class of grids is not very broad, let us rather focus on subgraphs of grids.

***

ä¸‹é¢ç»™å‡ºä¸€äº›è§„å®šï¼Œç»§ç»­å¾€ä¸‹çœ‹çš„æ—¶å€™å¦‚æœæ„Ÿåˆ°ç–‘æƒ‘è®°å¾—å›æ¥æŸ¥æŸ¥ğŸ˜µ

* $G$ï¼šæ•´ä¸ªå›¾ï¼Œå…¶ä¸º $k\times N$ ç½‘æ ¼å›¾çš„å­å›¾ï¼Œ$k$ å¾ˆå°ï¼ˆæ¯”å¦‚, $k=10$ï¼‰ï¼Œ$N$å¾ˆå¤§ï¼ˆæ¯”å¦‚, $N=10^{6}$ï¼‰
* $(i_1, j_1)$ å’Œ $(i_2, j_2)$ æ˜¯ç›¸é‚»çš„å½“ä¸”ä»…å½“$\vert$ $i_1-i_2$ $\vert$ $+$ $\vert$ $j_1-j_2$ $\vert$ $=1$
* $X_j$ ä¸ºå›¾ $G$ çš„ç¬¬ $j$ **åˆ—**ï¼Œå³$X_j=V(G) \cap \lbrace (i,j):1\leq{i}\leq{k}\rbrace$
* $G_j=G[X_1\cup X_2 \cup ... \cup X_j]$
* å¯¹äº $Y\subseteq X_j$, $c[j,Y]$ ä¸º$G_j-Y$é‡Œ$independent\,set$ï¼ˆå³æœ€ä¸Šé¢æè¿°çš„é‚£ç§ç‚¹é›†ï¼‰å¯èƒ½çš„æœ€å¤§æƒå€¼å’Œã€‚ 

ä»è§„å®šé‡Œä¹Ÿèƒ½çœ‹å‡ºæ¥ï¼Œæˆ‘ä»¬å°±æ˜¯è¦å»æ±‚$c[j,Y]$äº†

***

* å¯¹äº$j=1$çš„æƒ…å†µï¼Œæš´åŠ›æšä¸¾ï¼š

> For every $Y \subseteq X_1$, we iterate through all possible subsets $S\subseteq X_1 \setminus Y$ , and for each of them we check whether it is an independent set.

è¦è®¡ç®—åˆ°æ‰€æœ‰çš„$Y$ï¼Œæ€»å…±çš„"check"æ¬¡æ•°ï¼š
$$
\sum_{\ell=0}^{|X_1|}\dbinom{|X_1|}{\ell}2^{|X_1|-\ell}=3^{|X_1|}\leq3^k
$$
ä¸Šè¿°å¼å­è¦è€ƒè™‘é€‰å– $Y$ï¼ˆæšä¸¾æ’åˆ—ç»„åˆï¼‰å’Œå¯¹æ¯ä¸€ä¸ª $Y$ çš„æƒ…å†µæšä¸¾æ‰¾ç‹¬ç«‹é›†ã€‚

* å¯¹äº$j\gt {1}$çš„æƒ…å†µï¼Œ$dp$å»è§£ï¼š

$$
c[j,Y]={max}_{S\subseteq X_j \setminus Y,S\,is\, independent} \lbrace w(S)+c[j-1,N(S)\cap X_{j-1}]\rbrace
$$

è¿™é‡Œ$w(S)=\sum_{v\in S}w(v)$ï¼Œæ³¨æ„$S$æ˜¯$independent\, set$ï¼Œ$N(S)$ä¸º$S$åœ¨ä¸Šä¸€åˆ—çš„é‡Œå®Œæ•´ç½‘æ ¼å›¾å¯¹åº”çš„ç‚¹é›†ï¼ˆå…¶å®å°±æ˜¯é‚»å±…ï¼‰ï¼Œä¸$X_{j-1}$å–äº¤å°±è·å¾—äº†æ‰€è°“ä¸Šä¸€åˆ—é‡Œæˆ‘ä»¬éœ€è¦çš„$forbidden\, set$ï¼Œæ’ç‚¹åŸæ–‡

> Similarly, for $j = 1$, we should iterate through all the possible ways a maximum weight independent set intersects column $X_j$. This intersection should be independent, of course, and moreover if we pick some $v\in X_j \setminus Y$  to the independent set, then this choice forbids choosing its neighbor in the previous column $X_{j-1}$ (providing this neighbor exists).

 <img :src="$withBase('/treewidth.png')">  

æ— è®ºæ˜¯å“ªç§æƒ…å†µï¼Œè®¡ç®—é‡éƒ½åœ¨$3^k$Â· $k^{O(1)}$ä»¥å†…ï¼Œæœ€åæ—¶é—´å¤æ‚åº¦$3^k$ Â· $k^{O(1)}$Â·$N$.

