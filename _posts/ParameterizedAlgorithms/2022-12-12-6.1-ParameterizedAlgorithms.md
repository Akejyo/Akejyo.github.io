---
title: "Parameterized algorithms"
date: 2022-12-12
categories: [Study, Algorithms]
tags:	[parameterized algorithms]
math: true
---

<!-- more -->

# Parameterized algorithms

## 6.1.1 Parameterized algorithms

### Set Cover 

> parameterized algorithms 6.1.1

$F$ is the family of sets over a universe $U$, $k$ is a positive integer. The task is to check whether there exists a subfamily $F' \subseteq F$ of size $k$ that covers $U$, which means that every element of $U$ belongs to some set of $F'$.

**Theorem** *Given a Set Cover instance $(U,F, k)$, the minimum possible size of a subfamily $F'\subseteq F$ that covers $U$ can be found in time $2^{|U|}(|U|+|F|)^{O(1)}$.*

*Proof.*  We define $T[X,j]$ as the minimum possible size of a subset $F'$ $\subseteq$ $\lbrace$ $F_{1},F_{2},...,F_{j}\rbrace$ that covers $X$. If no such subset $F'$ exists, then $T[X,j]=+\infty$. We compute all $2^{|U|}(|F|+1)$ values $T[X,j]$.

* If $j=0$, $T[\emptyset,0]=0$ while $T[X,0]=+\infty$ for $X\neq 0$

* else, let $X \subseteq U$ and $0\lt{j}\leq{|F|}$, we have
  $$
  T[X,j]=min(T[X,j-1],1+T[X/F_j,j-1])
  $$

### Steiner Tree

> parameterized algorithms 6.1.2
>
> [Steiner Tree in OIwiki](https://oi-wiki.org/graph/steiner-tree/)

Let $G$ be an undirected graph on  $n$ vertices and $K \subseteq V(G)$ be a set of *terminals*, A *Steiner tree* for $K$ in $G$ is a connected subgraph $H$ of $G$ containing $K$, that is, $K \subseteq V(H)$.

The goal of this section is to design a dynamic-programming algorithm for Stenier tree with running time $3^{|K|}n^{O(1)}$, where $n=|V(G)|$.

**Lemma**   *For every $D \subseteq K$ of size at least $2$, and every $v \in V(G)\setminus K$, the following holds*
$$
T[D,v]=min\lbrace {T[D',u]+T[D\setminus D',u]+dist(v,u)}  \rbrace
$$
 where $T[D,v]$ means the minimum possible weight of a Steiner tree for $D \cup \lbrace v \rbrace$ in $G$, $u\in V(G)\setminus K$ and $\emptyset$ $\neq$ $D' \subsetneq D$

## 7.1 Treewidth

â€‹	è¯¥èŠ‚æ˜¯ç”±**æ ‘å½¢DP**çš„ä¸€ä¸ªç»å…¸[é¢˜ç›®](https://oi-wiki.org/dp/tree/)å»¶ä¼¸è€Œæ¥ã€‚ç»™ä½ ä¸€ä¸ªæ ‘ï¼ŒèŠ‚ç‚¹æœ‰æƒå€¼ï¼Œå½“ä½ é€‰æ‹©ä¸€ä¸ªèŠ‚ç‚¹åï¼Œä½ è·å¾—è¯¥ç‚¹çš„æƒå€¼ä½†å…¶ç›¸é‚»èŠ‚ç‚¹ä¸èƒ½è¢«é€‰ï¼Œé—®èƒ½è·å¾—åˆ°çš„æœ€å¤§æƒå€¼ã€‚

> We shall call this problem **Weighted Independent Set.**

â€‹	ç”±äºæ ‘çš„ç»“æ„ç‰¹æ€§ï¼Œä¸Šè¿°é—®é¢˜å¯ä»¥ä¸€é $dfs$ è·‘æ‰ï¼Œå…·ä½“å¯ä»¥ç‚¹ä¸Šé¢çš„é“¾æ¥æŸ¥çœ‹ã€‚

â€‹	é‚£ä¹ˆï¼Œä¸æ˜¯æ ‘çš„æƒ…å†µçš„è¯¥æ€ä¹ˆè§£å†³å‘¢ï¼Ÿæœ¬èŠ‚é‡Œä»‹ç»äº†ç½‘æ ¼å›¾çš„è§£å†³æ–¹æ¡ˆï¼Œæ›´å…·ä½“ä¸€ç‚¹ï¼Œæ˜¯"narrow grids"çš„å­å›¾ã€‚

> Since the class of grids is not very broad, let us rather focus on subgraphs of grids.

***

ä¸‹é¢ç»™å‡ºä¸€äº›è§„å®šï¼Œç»§ç»­å¾€ä¸‹çœ‹çš„æ—¶å€™å¦‚æœæ„Ÿåˆ°ç–‘æƒ‘è®°å¾—å›æ¥æŸ¥æŸ¥ğŸ˜µ

* $G$ï¼šæ•´ä¸ªå›¾ï¼Œå…¶ä¸º $k\times N$ ç½‘æ ¼å›¾çš„å­å›¾ï¼Œ$k$ å¾ˆå°ï¼ˆæ¯”å¦‚, $k=10$ï¼‰ï¼Œ$N$å¾ˆå¤§ï¼ˆæ¯”å¦‚, $N=10^{6}$ï¼‰
* $(i_1, j_1)$ å’Œ $(i_2, j_2)$ æ˜¯ç›¸é‚»çš„å½“ä¸”ä»…å½“$\vert$ $i_1-i_2$ $\vert$ $+$ $\vert$ $j_1-j_2$ $\vert$ $=1$
* $X_j$ ä¸ºå›¾ $G$ çš„ç¬¬ $j$ **åˆ—**ï¼Œå³$X_j=V(G) \cap \lbrace (i,j):1\leq{i}\leq{k}\rbrace$
* $G_j=G[X_1\cup X_2 \cup ... \cup X_j]$
* å¯¹äº $Y\subseteq X_j$, $c[j,Y]$ ä¸º$G_j-Y$é‡Œ$independent\,set$ï¼ˆå³æœ€ä¸Šé¢æè¿°çš„é‚£ç§ç‚¹é›†ï¼‰å¯èƒ½çš„æœ€å¤§æƒå€¼å’Œã€‚ 

ä»è§„å®šé‡Œä¹Ÿèƒ½çœ‹å‡ºæ¥ï¼Œæˆ‘ä»¬å°±æ˜¯è¦å»æ±‚$c[j,Y]$äº†

***

* å¯¹äº$j=1$çš„æƒ…å†µï¼Œæš´åŠ›æšä¸¾ï¼š

> For every $Y \subseteq X_1$, we iterate through all possible subsets $S\subseteq X_1 \setminus Y$ , and for each of them we check whether it is an independent set.

è¦è®¡ç®—åˆ°æ‰€æœ‰çš„$Y$ï¼Œæ€»å…±çš„"check"æ¬¡æ•°ï¼š
$$
\sum_{\ell=0}^{|X_1|}\dbinom{|X_1|}{\ell}2^{|X_1|-\ell}=3^{|X_1|}\leq3^k
$$
ä¸Šè¿°å¼å­è¦è€ƒè™‘é€‰å– $Y$ï¼ˆæšä¸¾æ’åˆ—ç»„åˆï¼‰å’Œå¯¹æ¯ä¸€ä¸ª $Y$ çš„æƒ…å†µæšä¸¾æ‰¾ç‹¬ç«‹é›†ã€‚

* å¯¹äº$j\gt {1}$çš„æƒ…å†µï¼Œ$dp$å»è§£ï¼š

$$
c[j,Y]={max}_{S\subseteq X_j \setminus Y,S\,is\, independent} \lbrace w(S)+c[j-1,N(S)\cap X_{j-1}]\rbrace
$$

è¿™é‡Œ$w(S)=\sum_{v\in S}w(v)$ï¼Œæ³¨æ„$S$æ˜¯$independent\, set$ï¼Œ$N(S)$ä¸º$S$åœ¨ä¸Šä¸€åˆ—çš„é‡Œå®Œæ•´ç½‘æ ¼å›¾å¯¹åº”çš„ç‚¹é›†ï¼ˆå…¶å®å°±æ˜¯é‚»å±…ï¼‰ï¼Œä¸$X_{j-1}$å–äº¤å°±è·å¾—äº†æ‰€è°“ä¸Šä¸€åˆ—é‡Œæˆ‘ä»¬éœ€è¦çš„$forbidden\, set$ï¼Œæ’ç‚¹åŸæ–‡

> Similarly, for $j = 1$, we should iterate through all the possible ways a maximum weight independent set intersects column $X_j$. This intersection should be independent, of course, and moreover if we pick some $v\in X_j \setminus Y$  to the independent set, then this choice forbids choosing its neighbor in the previous column $X_{j-1}$ (providing this neighbor exists).

 <img :src="$withBase('/treewidth.png')">  

æ— è®ºæ˜¯å“ªç§æƒ…å†µï¼Œè®¡ç®—é‡éƒ½åœ¨$3^k$Â· $k^{O(1)}$ä»¥å†…ï¼Œæœ€åæ—¶é—´å¤æ‚åº¦$3^k$ Â· $k^{O(1)}$Â·$N$.

## 7.2 Treewidth

### Path decomposition

å›¾ $G$ çš„ä¸€ä¸ªè·¯å¾„åˆ†è§£æ˜¯ä¸€ä¸ªåŒ… $bag$ çš„åºåˆ—$P=(X_1,X_2,...,X_r)$ï¼Œæ»¡è¶³ï¼š

$(P1)$ $\bigcup_{i=1}^{r}X_i=V(G)$ï¼Œå³ $G$ çš„æ¯ä¸ªç‚¹éƒ½è‡³å°‘åœ¨ä¸€ä¸ªåŒ…é‡Œ.

$(P2)$ è‹¥è¾¹$(u, v)$å±äº$G$ï¼Œé‚£ä¹ˆå­˜åœ¨ä¸€ä¸ª bag åŒæ—¶åŒ…å«äº† $u$ å’Œ $v$.

$(P3)$ è‹¥ $u \in V(G)$ï¼Œä¸”$u\in X_i \cap X_k$ï¼Œ$i \leq k$ï¼Œé‚£ä¹ˆæœ‰$u\in X_j$ï¼Œ$i\leq {j}\leq{k}$.

***

* è·¯å¾„åˆ†è§£çš„**å®½åº¦** $width$ï¼š ${max}_{1\leq{i}\leq{r}}$ $\vert$ $X_i$ $\vert$ $-1.$

* è·¯å¾„åˆ†è§£çš„**è·¯å¾„å®½åº¦** $pathwidth$ ï¼Œå³pw($G$): the minimum possible width of a path decomposition of $G$. 

* $(A,B)$æ˜¯ä¸€ä¸ª$separation$ å½“: $A \cup B=V(G)$ï¼Œä¸”åœ¨ $A \setminus B$ å’Œ $B\setminus A$ ä¹‹é—´æ²¡æœ‰è¾¹ç›¸è¿ï¼Œè¿™æ—¶$A\cap B$å°±æ˜¯è¿™ä¸ª$separation$çš„$separator$(åˆ†éš”ç¬¦)ï¼Œ$\vert$ $A\cap B$ $\vert$ç§°ä¸º$order$.

* å¯¹äºå­é›† $A \subseteq V(G)$ï¼Œ**è¾¹ç•Œ**$border$: $\partial(A)$ ç”± $A$ ä¸­æ‹¥æœ‰åœ¨ $V(G)\setminus A$ é‡Œçš„é‚»å±…çš„ç‚¹ç»„æˆ.

> the set of those vertices of $A$ that have a neighbor in $V(G)\setminus A$

***Lemma 1*** *$(\bigcup_{i=1}^jX_i,\bigcup_{i=j+1}^rX_i)$ is a $separation$ of $G$ with $separator$ $X_j\cap X_{j+1}$*

â€‹		è¯æ˜å¯ç”¨åè¯æ³•ï¼Œå¯èƒ½ä¼šç”¨åˆ°ä¸Šé¢çš„$(P2)(P3)$.

***

ä¸€ä¸ªè·¯å¾„åˆ†è§£æ˜¯ $nice$ çš„ï¼Œå¦‚æœéµå¾ªä¸‹é¢çš„æ¡ä»¶ï¼š

* $X_1=X_r=\emptyset$.
* å¯¹äºæ¯ä¸€ä¸ª$i\in \lbrace 1,2,...,r-1\rbrace$ï¼Œè¦ä¹ˆæœ‰ä¸€ä¸ªç‚¹$v\notin X_i$ä¸”$X_{i+1}=X_i\cup \lbrace v\rbrace$ï¼ˆæ­¤æ—¶ $X_{i+1}$ ç§°ä¸º$introduce\,\,bag$, $X_{i+1}\,\,introduces\,\,v$ï¼‰ï¼Œè¦ä¹ˆæœ‰ä¸€ä¸ªç‚¹ $w\in X_i$ ä¸” $X_{i+1}=X_i \setminus \lbrace w\rbrace$ï¼ˆç±»ä¼¼çš„ï¼Œç§°ä¸º$forget\,\,bag$ï¼‰.

> Let us note that because of $(P3)$, every vertex of $G$ gets introduced and becomes forgotten exactly once in a nice path decomposition, and hence we have that $r$, the total number of bags, is exactly equal to $2$$\vert$$V(G)$$\vert$$+1$.

***Lemma 2*** *å¦‚æœ $G$ å­˜åœ¨å®½åº¦ä¸º $p$ çš„è·¯å¾„åˆ†è§£ï¼Œé‚£ä¹ˆå…¶ä¹Ÿå­˜åœ¨ä¸€ä¸ª $nice$ çš„å®½åº¦æœ€å¤§ä¸º $p$ çš„è·¯å¾„åˆ†è§£ã€‚å¦å¤–ï¼Œç»™å®š $G$ çš„å®½åº¦ä¸º $p$ çš„è·¯å¾„åˆ†è§£$P=(X_1,X_2,...,X_r)$ï¼Œå¯åœ¨$O(p^2$Â·$max(r,$$\vert$ $V(G)$$\vert$$))$å†…æ±‚å¾— $nice$ çš„å®½åº¦ $p$ è·¯å¾„åˆ†è§£*

***

### Tree decompositions

æ ‘åˆ†è§£æ˜¯è·¯å¾„åˆ†è§£çš„ä¸€ä¸ªå»¶ä¼¸

å›¾ $G$ çš„ä¸€ä¸ªæ ‘åˆ†è§£$tree\,\,decomposition$æ˜¯ä¸€ä¸ªpair $\mathcal T=(T,\lbrace X_t\rbrace_{t\in V(T)})$ï¼Œå…¶ä¸­ $T$ æ˜¯ä¸€ä¸ªæ ‘ï¼Œæ ‘çš„æ¯ä¸ªèŠ‚ç‚¹ $t$ éƒ½åˆ†é…æœ‰å­ç‚¹é›† $X_t\subseteq V(G)$ï¼Œç§°ä¸ºåŒ… $bag$ï¼Œéµå¾ªä¸‹é¢è§„åˆ™ï¼š

$(T1)$ $\bigcup_{t\in V(T)}X_t=V(G)$ï¼Œå³å›¾ $G$ çš„æ¯ä¸ªç‚¹éƒ½è‡³å°‘åœ¨ä¸€ä¸ªåŒ…é‡Œ.

$(T2)$ å¯¹äºå›¾ $G$ çš„æ¯ä¸€æ¡è¾¹ $(u,v)$ï¼Œéƒ½å­˜åœ¨æ ‘ $T$ çš„ä¸€ä¸ªèŠ‚ç‚¹ $t$ æ»¡è¶³ $X_t$ åŒæ—¶åŒ…å«äº† $u$ å’Œ $v$ .

$(T3)$ å¯¹äºå›¾ $G$ çš„æ¯ä¸€ä¸ªç‚¹ $u$ï¼Œé›†åˆ $T_u=\lbrace t\in V(T):u\in X_t\rbrace$ï¼Œå¯¹åº”çš„åŒ…ä¸­åŒ…å« $u$ çš„èŠ‚ç‚¹é›†åˆï¼Œå°±å¾—åˆ°äº† $T$ çš„ä¸€ä¸ªè¿é€šå­æ ‘.

> â€‹	the set of nodes whose corresponding bags contain $u$, induces a connected subtree of T.

***

* æ ‘åˆ†è§£çš„**å®½åº¦**$width$ï¼š$max_{t\in V(T)}$$\vert$$X_t$$\vert$$-1$
* æ ‘åˆ†è§£çš„**æ ‘å®½åº¦**$treewidth$ï¼Œå³tw(G)ï¼šis the minimum possible width of a tree decomposition of $G$.

***Lemma 3*** *è®¾ $T$ æ˜¯å›¾ $G$ çš„ä¸€ä¸ªæ ‘åˆ†è§£ï¼Œ$ab$ æ˜¯ $T$ çš„ä¸€æ¡è¾¹ï¼Œé‚£ä¹ˆæ£®æ— $T-ab$ åŒ…å«äº†ä¸¤ä¸ªç›¸è¿çš„éƒ¨åˆ† $T_a(containing\,\,a)$ï¼Œ$T_b(containing\,\,b)$. è®¾ $A=\bigcup_{t\in V(T_a)}X_t$ï¼Œ$B=\bigcup_{t\in V(T_b)}X_t$ï¼Œé‚£ä¹ˆå°±æœ‰ $\partial(A),\partial(B)\subseteq X_a \cap X_b$ï¼ŒåŒæ ·$(A,B)$å°±æ˜¯å›¾ $G$ ä»¥ $X_a \cap X_b$ä¸º$separator$çš„ä¸€ä¸ª$separation$.*

***

ä¸€ä¸ªæ ‘åˆ†è§£æ˜¯ $nice$ çš„ï¼Œå¦‚æœæ»¡è¶³ï¼š

* $X_r=\emptyset,X_{\ell}=\emptyset$ï¼Œå…¶ä¸­ $r$ æ˜¯æ ‘ $T$ çš„æ ¹ï¼Œ$\ell$ æ˜¯æ ‘çš„æ¯ä¸€ä¸ªå¶å­.
* ä»»æ„ä¸æ˜¯å¶å­èŠ‚ç‚¹çš„èŠ‚ç‚¹éƒ½æ˜¯ä¸‹é¢ä¸‰ç§ç±»å‹ä¹‹ä¸€ï¼š
  * $\bold{Introduce\,\,node}$: èŠ‚ç‚¹ $t$ æ°å¥½åªæœ‰ä¸€ä¸ªå­©å­ $t'$ ä¸”æœ‰ $X_t=X_{t'}\cup \lbrace v \rbrace$ï¼Œ$v\notin X_{t'}$æ­¤æ—¶æˆ‘ä»¬è¯´$v$ is $introduced$ at $t$.
  * $\bold{Forget\,\,node}$: èŠ‚ç‚¹ $t$ æ°å¥½åªæœ‰ä¸€ä¸ªå­©å­ $t'$ ä¸”æœ‰ $X_t=X_{t'}\setminus \lbrace w \rbrace$ï¼Œ$w\in X_{t'}$ï¼Œæ­¤æ—¶æˆ‘ä»¬è¯´$w$ is $forgotten$ at $t$
  * $\bold{Join\,\,node}$: èŠ‚ç‚¹ $t$ æœ‰ä¸¤ä¸ªå­©å­ $t_1,t_2$ï¼Œä¸” $X_t=X_{t_1}=X_{t_2}$

> Note also that, by property $(T3)$ of a tree decomposition, every vertex of $V(G)$ is forgotten only once, but may be introduced several times.

***

***Lemma 4*** *å¦‚æœå›¾ $G$ å…è®¸ä¸€ä¸ªå®½åº¦è‡³å¤šä¸º $k$ çš„æ ‘åˆ†è§£ï¼Œé‚£ä¹ˆå®ƒä¹Ÿèƒ½åšåˆ°ä¸€ä¸ªå®½åº¦è‡³å¤šä¸º $k$ çš„ $nice$ æ ‘åˆ†è§£. å¦å¤–ï¼Œç»™å®šå›¾ $G$ çš„ä¸€ä¸ªå®½åº¦ä¸º $k$ çš„æ ‘åˆ†è§£ $\mathcal T=(T,\lbrace X_t\rbrace_{t\in V(T)})$ï¼Œå¯ä»¥åœ¨ $O(k^2$Â·$max($$\vert$$V(T)$$\vert$,$\vert$$V(G)$$\vert$$))$å†…æ±‚å¾—å›¾ $G$ çš„ä¸€ä¸ªå®½åº¦ä¸º $k$ ã€æ‹¥æœ‰æœ€å¤š $O(k$$\vert$$V(G)$$\vert$$)$ä¸ªèŠ‚ç‚¹çš„ $nice$ æ ‘åˆ†è§£*

## 7.3.1 WeightedIndependentSet

è®¾ $\mathcal T=(T,\lbrace X_t \rbrace_{t\in V(T)})$ æ˜¯ $n$ èŠ‚ç‚¹å›¾ $G$ çš„ä¸€ä¸ªæ ‘åˆ†è§£ï¼Œå®½åº¦è‡³å¤šä¸º $k$ï¼Œå¯¹äºæ ‘ä¸Šä¸€èŠ‚ç‚¹ $t$ï¼Œ$t\neq r$ï¼Œä»¤ $V_t$ä¸ºæ ‘ $T$ ä»¥ $t$ ä¸ºæ ¹çš„å­æ ‘é‡Œçš„åŒ…çš„å¹¶é›†ï¼ŒåŒ…æ‹¬ $X_t$. é‚£ä¹ˆæ ¹æ®[**Lemma 7.3**](https://akejyo.github.io/blog/posts/2022/12/21/treewidth-7-2.html#tree-decompositions )æœ‰ $\partial(V_t)\subseteq X_t$.

> This exactly formalizes the intuition that the subgraph induced by $V_t$ can communicate with the rest of the graph only via bag $X_t$, which is of small size.

***

â€‹	å°†ç‹¬ç«‹é›†é—®é¢˜ä¸åŒ… $X_t$ è”ç³»èµ·æ¥ï¼šä»¤å›¾ $G$ çš„ä¸¤ä¸ªç‹¬ç«‹é›† $I_1,I_2$ æ»¡è¶³ $I_1\cap X_t=I_2\cap X_t$ï¼Œæˆ‘ä»¬æŠŠ $I_1,I_2$ åœ¨ $V_t$ é‡Œçš„ç‚¹çš„æƒå€¼åŠ èµ·æ¥ï¼Œå¹¶å‡è®¾ **w** $(I_1\cap V_t)\gt$**w**$(I_2\cap V_t)$ï¼Œé‚£ä¹ˆå°±å¯ä»¥è·å¾—ä¸€ä¸ªæ›´å¥½çš„æ–¹æ¡ˆ $I_2'$ï¼Œé€šè¿‡æŠŠ $I_2$ é‡Œçš„ $I_2 \cap V_t$ æ›¿æ¢æˆ $I_1\cap V_t$. ç”±å‰æ $I_1\cap X_t=I_2\cap X_t$ ä»¥åŠç»“è®º $\partial(V_t)\subseteq X_t$ æˆ‘ä»¬å¯ä»¥çŸ¥é“ $I_2'$ ä¾ç„¶æ˜¯ç‹¬ç«‹é›†ï¼Œå³æˆ‘ä»¬ä»  **w** $(I_1\cap V_t)\gt$**w**$(I_2\cap V_t)$ å¾—åˆ°äº† **w**$(I_2')$>**w**$(I_2)$

â€‹	ç°åœ¨é—®é¢˜æœ‰äº†äº›è®¸è½¬åŒ–. å¯¹äºä¸€ä¸ª $S\subseteq X_t$ï¼Œæˆ‘ä»¬è¯•å›¾å»æ‰¾åˆ°ä¸€ä¸ª**æƒå€¼æœ€å¤§**çš„æ‹“å±•é›† $\hat{S} \supseteq S$ï¼Œä¸”æœ‰ $\hat{S} \subseteq V_t,\hat{S}\cap X_t=S$ï¼Œ$\hat{S}$ è¿˜æ˜¯ç‹¬ç«‹é›†. æ ¹æ®ä¸Šä¸€æ®µè®¨è®ºï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“$solution$ $I$åœ¨ $V_t$ é‡Œçš„éƒ¨åˆ†æ˜¯å¯ä»¥å®‰å…¨æ›¿æ¢æˆ $\hat{S}$ çš„. 

> this replacement preserves independence and can only increase the weight. Observe that the number of subproblems is small: for every node $t$,  we have only $2^{|X_t|}$ subproblems. Also, we do not need to remember $\hat{S}$ explicitly; remembering its weight will suffice.

â€‹	å¯¹äºæ¯ä¸ªèŠ‚ç‚¹ $t$ï¼ˆè¿™é‡ŒåŸæ–‡æ˜¯ $node$ï¼ŒåŸæ–‡æœ‰æ $node$ æŒ‡çš„æ˜¯æ ‘åˆ†è§£çš„æ ‘ä¸ŠèŠ‚ç‚¹ï¼‰å’Œæ¯ä¸ª $S\subseteq X_t$ï¼Œæœ‰å¦‚ä¸‹å®šä¹‰ï¼š
$$
c[t,S]=maximum\,\,possible\,\,weight\,\,of\,\,a\,\,set\,\,\hat{S}\,\,such\,\,that
$$

$$
\,\,S\subseteq\hat{S}\subseteq V_t,\hat{S}\cap X_t=S,and\,\,\hat{S}\,\,is\,\,independent
$$

â€‹	å¦‚æœæ²¡æœ‰è¿™æ ·çš„ $\hat{S}$ å­˜åœ¨ï¼ˆå³ $S$ ä¸æ˜¯ç‹¬ç«‹é›†ï¼‰ï¼Œå°±è¯´ $c[t,S]=-\infty$ï¼Œ$c[r,{\emptyset}]$ å°±æ˜¯æ•´ä¸ªå›¾ $G$ çš„æœ€å¤§ç‹¬ç«‹é›†ï¼ˆå› ä¸º $V_r=V(G)$ ä¸” $X_r=\emptyset$ï¼‰.

â€‹	ä¸‹é¢å°±æ¥è®¡ç®— $c[,]$

***

â€‹	ä¸‹é¢éƒ½æ˜¯åŸºäº $nice$ æ ‘åˆ†è§£çš„.

$\bold{Leaf\,\,node}$: $c[t,\emptyset]=0$

$\bold{Introduce\,\,node}$: $t$ æ˜¯ä¸€ä¸ªintrodece nodeï¼Œå…¶å­©å­èŠ‚ç‚¹ä¸º $t'$ï¼Œ$X_t=X_{t'}\cup\{v\}$ï¼Œ$S$ æ˜¯ $X_t$ çš„ä»»æ„å­é›†. è‹¥ $S$ ä¸æ˜¯ç‹¬ç«‹é›†ï¼Œæœ‰ $c[t,S]=-\infty$ï¼›å¦åˆ™ï¼Œæœ‰ä»¥ä¸‹å…¬å¼ï¼š
$$
c[t,S]=
\begin{cases} 
c[t',S]&\text{if } v\notin S \\
c[t',S\setminus \{v\}]+w(v)&\text{otherwise }
\end{cases}
$$
**è¯æ˜**ï¼š

â€‹	å…ˆçœ‹ $v\notin S$çš„æƒ…å†µï¼Œæ­¤æ—¶å¯ä»¥åˆ¤æ–­ the families of $\hat{S}$ åœ¨ $c[t,S]$ å’Œ $c[t',S]$ ä¸Šæ˜¯ä¸€æ ·çš„ï¼ˆå› ä¸ºæœ‰ $\hat{S}\cap X_t=S$ é™åˆ¶ï¼Œå–ä¸åˆ° $v$ ï¼‰ï¼Œæ˜¾ç„¶å°±æœ‰ $c[t,S]=c[t',S]$ï¼›

â€‹	å¯¹äº $v\in S$ çš„æƒ…å†µï¼Œä»ä¸¤ä¸ªè§’åº¦å»çœ‹ï¼šå‡è®¾ $\hat{S}$ æ˜¯åŸºäº $c[t,S]$ æœ€å¤§æƒå€¼å®šä¹‰ä¸Šçš„ä¸€ä¸ªé›†åˆï¼Œé‚£ä¹ˆå°±æœ‰ $\hat{S}\setminus\{v\}$ æ˜¯åŸºäº $c[t',S\setminus\{v\}]$ ä¸Šçš„ä¸€ä¸ªé›†åˆï¼Œä¸”æœ‰ $c[t',S\setminus\{v\}]\ge w(\hat{S}\setminus\{v\})=w(\hat{S})-w(v)=c[t,S]-w(v)$ï¼Œæœ€åå¾—åˆ°ï¼š
$$
c[t,S]\le c[t',S\setminus\{v\}]+w(v)
$$
â€‹	ä»å¦ä¸€ä¸ªè§’åº¦ï¼Œè®¾ $\hat{S'}$ æ˜¯åŸºäº $c[t',S\setminus \{v\}]$ æœ€å¤§æƒå€¼å®šä¹‰çš„ä¸€ä¸ªé›†åˆ. å› ä¸º $S$ æ˜¯ç‹¬ç«‹çš„ï¼Œ$v$ ä¸ä¼šæœ‰é‚»å±…åœ¨ $S\setminus\{v\}=\hat{S'}\cap X_{t'}$ é‡Œï¼Œå†ä¾æ® [**Lemma 7.3**](https://akejyo.github.io/blog/posts/2022/12/21/treewidth-7-2.html#tree-decompositions ) å¯ä»¥å¾—åˆ° $v$ æ²¡æœ‰é‚»å±…åœ¨ $V_{t'}\setminus X_{t'}$ï¼ˆå¦‚æœæœ‰é‚»å±…ï¼Œé‚£ä¹ˆ $v$ ä½œä¸ºè¾¹ç•Œçš„ä¸€éƒ¨åˆ†æ˜¯å±äº $X_t\cap X_{t'}=X_{t'}$ï¼Œä½†æ˜¯ $X_{t'}$ ä¸å« $v$ï¼‰ï¼Œ$V_{t'}\setminus X_{t'}$ æ˜¯ $\hat{S'}\setminus X_{t'}$ çš„è¶…é›†. æ‰€ä»¥ $v$ æ²¡æœ‰é‚»å±…åœ¨ $\hat{S'}\setminus X_{t'}$ å’Œ $\hat{S'}\cap X_{t'}$ é‡Œï¼Œå³ $v$ æ²¡æœ‰é‚»å±…åœ¨ $\hat{S'}$ é‡Œï¼Œ $\hat{S'}\cup\{v\}$ æ˜¯ä¸€ä¸ªç‹¬ç«‹é›†. ç”± $(\hat{S'}\cup\{v\})\cap X_t=S$ï¼Œæœ‰ï¼š
$$
c[t,S]\ge w(\hat{S'}\cup\{v\})=w(\hat{S'})+w(v)=c[t',S\setminus\{v\}]+w(v)
$$
â€‹	ç”±$\le$å’Œ$\ge$å°±å¾—å‡º $c[t,S]=c[t',S\setminus\{v\}]+w(v)$.

â€‹	å¤šå¯¹ç…§ $c[t,S]$ çš„å®šä¹‰å’Œ [**Lemma 7.3**](https://akejyo.github.io/blog/posts/2022/12/21/treewidth-7-2.html#tree-decompositions ) æ¥çœ‹è¦å®¹æ˜“ä¸€ç‚¹. 

$\bold{Forget\,\,node}$: $t$ æ˜¯ä¸€ä¸ªforget nodeï¼Œå…¶å­©å­èŠ‚ç‚¹ä¸º $t'$ï¼Œ$X_t=X_{t'}\setminus\{v\}$. $S$ æ˜¯ $X_t$ çš„ä»»æ„å­é›†. è‹¥ $S$ ä¸æ˜¯ç‹¬ç«‹é›†ï¼Œæœ‰ $c[t,S]=-\infty$ï¼›å¦åˆ™æœ‰ï¼š
$$
c[t,S]=max\{c[t',S],c[t',S\cup\{v\}]\}
$$
 **è¯æ˜**ï¼š

â€‹	è®¾ $\hat{S}$ æ˜¯åŸºäº $c[t,S]$ æœ€å¤§æƒå€¼å®šä¹‰ä¸Šçš„ä¸€ä¸ªé›†åˆ. è‹¥ $v\notin \hat{S}$ï¼Œé‚£ä¹ˆ $\hat{S}$ å°±å±äº $c[t',S]$ æ‰€è¦è€ƒè™‘çš„é›†åˆä¸­çš„ä¸€ä¸ªï¼ˆå¯ä» $c[t,S]$ çš„å®šä¹‰åˆ†æï¼‰ï¼Œäºæ˜¯å°±æœ‰ $c[t',S]\ge w(\hat{S})=c[t,S]$ï¼›è‹¥ $v\in \hat{S}$ï¼Œé‚£ä¹ˆ $\hat{S}$ å°±å±äº $c[t',S\cup\{v\}]$ æ‰€è¦è€ƒè™‘çš„é›†åˆä¸­çš„ä¸€ä¸ªï¼Œäºæ˜¯å°±æœ‰ $c[t',S\cup\{v\}]\ge w(\hat{S})=c[t,S]$. æœ€åå¾—åˆ°ï¼š
$$
c[t,S]\le max\{c[t',S],c[t',S\cup\{v\}]\}
$$
â€‹	æ³¨æ„åˆ°åœ¨åŸºäº $c[t',S]$ çš„å®šä¹‰ä¸‹æ‰€è¦è€ƒè™‘åˆ°çš„é›†åˆ $\hat{S}$ï¼ŒåŒæ ·ä¹Ÿä¼šåœ¨åŸºäº $c[t,S]$ å’Œ $c[t',S\cup\{v\}]$ çš„å®šä¹‰ä¸‹è¢«è€ƒè™‘ï¼Œäºæ˜¯å°±æœ‰ $c[t,S]\ge c[t',S]$ å’Œ $c[t,S]\ge c[t'.S\cup\{v\}]$. æœ€åæˆ‘ä»¬æœ‰ï¼š
$$
c[t,S]\ge max\{c[t',S],c[t',S\cup\{v\}]\}
$$
â€‹	ç”±$\le$å’Œ$\ge$å°±å¾—å‡º $c[t,S]=max\{c[t',S],c[t',S\cup\{v\}]\}$.

$\bold{Join\,\,node}$: $t$ æ˜¯ä¸€ä¸ª join nodeï¼Œå…¶ä¸¤ä¸ªå­©å­ $t_1,t_2$ æ»¡è¶³ $X_t=X_{t_1}=X_{t_2}$ï¼Œ$S$ ä¸º $X_t$ çš„ä»»æ„å­é›†ï¼›å’Œå¾€å¸¸ä¸€æ ·è€ƒè™‘ $S$ æ˜¯ä¸€ä¸ªç‹¬ç«‹é›†ï¼Œæˆ‘ä»¬æœ‰ï¼š
$$
c[t,S]=c[t_1,S]+c[t_2,S]-w(S)
$$
**è¯æ˜**ï¼š

â€‹	è®¾ $\hat{S}$ æ˜¯åŸºäº $c[t,S]$ æœ€å¤§æƒå€¼å®šä¹‰ä¸Šçš„ä¸€ä¸ªé›†åˆ. ä»¤ $\hat{S_1}=\hat{S}\cap V_{t_1}$ï¼Œ$\hat{S_2}=\hat{S}\cap V_{t_2}$. æˆ‘ä»¬å¯ä»¥çœ‹åˆ° $\hat{S_1}$ æ˜¯ç‹¬ç«‹çš„ä¸” $\hat{S_1}\cap X_{t_1}=S$ï¼Œå› æ­¤ $\hat{S}$ ä¹Ÿæ˜¯åŸºäº $c[t_1,S]$ å®šä¹‰ä¸‹è¢«è€ƒè™‘çš„é›†åˆï¼Œäºæ˜¯å°±æœ‰ $c[t_1,S]\ge w(\hat{S_1})$ï¼ŒåŒæ ·ä¹Ÿèƒ½å¾—åˆ° $c[t_2,S]\ge w(\hat{S_2})$. ç”±äº $\hat{S_1}\cap \hat{S_2}=S$ï¼Œæœ€åå¯ä»¥å¾—åˆ°ï¼š
$$
c[t,S]=w(\hat{S})=w(\hat{S_1})+w(\hat{S_2})-w(S)\le c[t_1,S]+c[t_2,S]-w(S)
$$
â€‹	å¦ä¸€æ–¹é¢ï¼Œè®¾ $\hat{S'_1}$ æ˜¯åŸºäº $c[t_1,S]$ çš„æœ€å¤§æƒå€¼å®šä¹‰ä¸Šçš„ä¸€ä¸ªé›†åˆï¼Œ$\hat{S'_2}$ ä¹Ÿæ˜¯ç±»ä¼¼. é€šè¿‡[**Lemma 7.3**](https://akejyo.github.io/blog/posts/2022/12/21/treewidth-7-2.html#tree-decompositions )å¯ä»¥å¾—åˆ°åœ¨ $V_{t_1}\setminus X_t$ å’Œ $V_{t_2}\setminus X_t$ é‡Œçš„èŠ‚ç‚¹ä¹‹é—´æ²¡æœ‰è¾¹ç›¸è¿ï¼ˆ$separator$ å°±æ˜¯ $X_t$ è‡ªå·±ï¼‰ï¼Œè¿™è¡¨æ˜  $\hat{S'}:=\hat{S'_1}\cup\hat{S'_2}$ æ˜¯ç‹¬ç«‹çš„ï¼ˆ $\hat{S'_1}$ å’Œ $\hat{S'_2}$ æ˜¯ç‹¬ç«‹çš„ï¼Œ$V_{t_1}\setminus X_t$ å’Œ $V_{t_2}\setminus X_t$ é‡Œçš„èŠ‚ç‚¹ä¹‹é—´æ²¡æœ‰è¾¹ç›¸è¿ï¼Œ$\hat{S'_1}\subseteq V_{t_1}$ï¼Œ$\hat{S'_2}\subseteq V_{t_2}$ï¼Œé‚£æ˜¾ç„¶ä¸¤ä¸ªå¹¶èµ·æ¥ä¹Ÿæ˜¯ç‹¬ç«‹äº†ï¼‰. å¦å¤–æˆ‘ä»¬è¿˜æœ‰ $\hat{S'}\cap X_t=S$ï¼Œä¹Ÿå°±æ˜¯è¯´ $\hat{S'}$ æ˜¯åŸºäº $c[t,S]$ æ‰€è¦è€ƒè™‘çš„é›†åˆä¹‹ä¸€ï¼Œæœ€åå°±æœ‰ï¼š
$$
c[t,S]\ge w(\hat{S'})=w(\hat{S'_1})+w(\hat{S'_2})-w(S)=c[t_1,S]+c[t_2,S]-w(S)
$$
â€‹	ç”±$\le$å’Œ$\ge$å°±å¾—å‡º $c[t,S]=c[t_1,S]+c[t_2,S]-w(S)$.

***

ç°åœ¨ç¨åšæ€»ç»“ï¼Œç®—ç®—æ—¶é—´

> Recall that we are working on a tree decomposition of width at most $k$, which means that $\vert$$X_t$$\vert$ $\le k + 1$ for every node $t$. Thus at node $t$ we compute $2^{|X_t|} \le 2^{k+1}$ values of $c[t, S]$.

> Wrapping up, for every node $t$ it takes time $2^k$Â· $k^{O(1)}$ to compute all the values $c[t, S]$. Since we can assume that the number of nodes of the given tree decompositions is $O(kn)$ (see Lemma 7.4), the total running time of the algorithm is $2^k$Â·$k^{O(1)}$Â·$n$.

**Theorem 7.5** ç»™å®šä¸€ä¸ªæœ‰ $n$ ä¸ªèŠ‚ç‚¹çš„å¸¦æƒå›¾ $G$ï¼ŒåŒæ—¶ç»™å®šå®ƒçš„å®½åº¦è‡³å¤šä¸º $k$ çš„æ ‘åˆ†è§£ï¼Œé‚£ä¹ˆ $\bold{Weighted\,\,Independent\,\,Set}$é—®é¢˜å¯ä»¥åœ¨ $2^k$Â·$k^{O(1)}$Â·$n$ æ—¶é—´å†…å®Œæˆ.

**Corollary 7.6** ç»™å®šä¸€ä¸ªæœ‰ $n$ ä¸ªèŠ‚ç‚¹çš„å¸¦æƒå›¾ $G$ï¼ŒåŒæ—¶ç»™å®šå®ƒçš„å®½åº¦è‡³å¤šä¸º $k$ çš„æ ‘åˆ†è§£ï¼Œé‚£ä¹ˆ $\bold{Vertex\,\,Cover}$é—®é¢˜å¯ä»¥åœ¨ $2^k$Â·$k^{O(1)}$Â·$n$ æ—¶é—´å†…å®Œæˆ.

â€‹	è¿™äº›ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸Šç•Œä¼šåœ¨ç¬¬$14$ç« è¯´æ˜æ˜¯è¢«å›ºå®šé™åˆ¶äº†çš„.

## 7.3.2 Dominating Set

æœ¬èŠ‚æˆ‘ä»¬è¯•å›¾å»æ‰¾å›¾ $G$ çš„æœ€å°[æ”¯é…é›†](https://oi-wiki.org/graph/concept/#%E6%94%AF%E9%85%8D%E9%9B%86).

â€‹	é¦–å…ˆå¯¹æ ‘åˆ†è§£è¿›è¡Œäº›è®¸å˜åŒ–ï¼Œå¼•å…¥æ–°èŠ‚ç‚¹ $introduce\,\,edge\,\,node$ï¼Œä¹‹å‰çš„ $introduce\,\,node$ ç°åœ¨å« $introduce\,\,vertex\,\,node$.

$\bold{Introduce\,\,edge\,\,node}$: a node $t$, **labeled** with an edge $uv$ âˆˆ $E(G)$ such that $u, v$ âˆˆ $X_t$, and with exactly one child $t'$ such that $X_t = X_{t'}$. We say that edge $uv$ is introduced at $t$.

â€‹	åœ¨æ•´ä¸ªæ ‘åˆ†è§£é‡Œï¼Œæˆ‘ä»¬è¦æ±‚ $E(G)$ é‡Œçš„æ¯ä¸€æ¡è¾¹éƒ½æ°å¥½è¢«å¼•è¿›ï¼ˆ$introduced$ï¼‰ä¸€æ¬¡. ç»™å®šä¸€ä¸ª $nice$ æ ‘åˆ†è§£ï¼Œå¯é€šè¿‡ä¸‹é¢æ–¹æ³•å»è½¬åŒ–æˆæˆ‘ä»¬éœ€è¦çš„. ç”± $T(3)$ å¯ä»¥å¾—åˆ°ï¼Œå¯¹äºä¸€ä¸ª $nice$ æ ‘åˆ†è§£ï¼Œå…¶ä¸­çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹ $v$ éƒ½å­˜åœ¨å”¯ä¸€ä¸€ä¸ª $highest\,\,node$ ï¼Œè®°ä½œ $t(v)$ï¼Œä½¿å¾— $v\in X_{t(v)}$ï¼›å¦å¤–æœ‰ $X_{t(v)}$ çš„çˆ¶èŠ‚ç‚¹æ˜¯ä¸€ä¸ª $forget$ äº† $v$ çš„ $forget\,\,node$. å¯¹äº $E(G)$ ä¸­çš„æ¯ä¸€ä¸ªè¾¹ $uv$ ï¼Œæ ¹æ® $T(2)$ å¯ä»¥å¾—åˆ°ï¼Œè¦ä¹ˆ $t(u)$ æ˜¯ $t(v)$ çš„ç¥–å…ˆï¼Œè¦ä¹ˆåè¿‡æ¥. æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨ $t(u)$ å’Œå…¶çˆ¶èŠ‚ç‚¹ä¹‹é—´æ’å…¥ä¸€ä¸ª $introduce\,\,uv$ çš„èŠ‚ç‚¹.

> Moreover, the obtained tree decomposition still has $O(kn)$ nodes, since a graph of treewidth at most $k$ has at most $kn$ edges 

***

â€‹	å¯¹æ ‘åˆ†è§£é‡Œçš„æ¯ä¸ªèŠ‚ç‚¹ $t$ éƒ½å®šä¹‰å­å›¾ $G_t$: 
$$
G_t=(V_t,E_t=\{e:e\,\,\text{is}\,\,\text{introduced}\,\,\text{in}\,\,\text{the}\,\, \text{subtree}\,\,\text{rooted}\,\,\text{at}\,\,t\})
$$
â€‹	å¯¹æ ‘åˆ†è§£çš„èŠ‚ç‚¹æŸ“è‰² $f:X_t\to \{0,\hat{0},1\}$ï¼Œè¯¦ç»†è§ä¸‹ï¼š

* $\bold{Black}$: ä»£è¡¨ $1$ï¼Œæ‰€æœ‰çš„é»‘è‰²èŠ‚ç‚¹éƒ½å¿…é¡»è¢«åŒ…å«åœ¨ $G_t$ çš„éƒ¨åˆ†è§£é‡Œ.
* $\bold{White}$: ä»£è¡¨ $0$ï¼Œæ‰€æœ‰çš„ç™½è‰²èŠ‚ç‚¹éƒ½ä¸è¢«åŒ…å«åœ¨éƒ¨åˆ†è§£é‡Œï¼Œä¸”å¿…é¡»æ˜¯è¢«å…¶æ”¯é…çš„.
* $\bold{Grey}$: ä»£è¡¨ $\hat{0}$ï¼Œæ‰€æœ‰çš„ç°è‰²èŠ‚ç‚¹éƒ½ä¸è¢«åŒ…å«åœ¨éƒ¨åˆ†è§£é‡Œï¼Œä½†ä¸å¿…è¢«å…¶æ”¯é….

éœ€è¦å¼ºè°ƒçš„æ˜¯ï¼Œæˆ‘ä»¬ä¸ä¼šç¦æ­¢ç°è‰²èŠ‚ç‚¹è¢«æ”¯é…ï¼Œåªæ˜¯**ä¸å…³å¿ƒ**å®ƒä»¬ä¼šä¸ä¼šè¢«æ”¯é….

***

â€‹	$t$ å’Œ $f$ çš„æœ€å°å…¼å®¹é›†ï¼ˆ$minimum\,\,compatible\,\,set$ï¼‰$D\subseteq V_t$ï¼Œæ»¡è¶³ï¼š

* $D\cap X_t=f^{-1}(1)$ï¼Œ$f^{-1}(1)$ å³ $X_t$ä¸­çš„é»‘è‰²ç‚¹é›†åˆ.
* $V_t\setminus f^{-1}(\hat{0})$ ä¸­çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹è¦ä¹ˆåœ¨ $D$ é‡Œï¼Œè¦ä¹ˆæ˜¯åœ¨ $G_t$ é‡Œä¸ $D$ ä¸­çš„ä¸€ç‚¹ç›¸é‚». å³ $D$ æ”¯é… $V_t$ åœ¨ $G_t$ ä¸­çš„æ‰€æœ‰ç‚¹ï¼Œé™¤äº†å¯èƒ½çš„ $X_t$ é‡Œçš„ç°è‰²ç‚¹.

â€‹	å¯¹äº $X_t$ çš„æ¯ä¸€ä¸ªæŸ“è‰²æ–¹æ¡ˆ $f$ï¼Œæˆ‘ä»¬ç”¨ $c[t,f]$ æ¥è¡¨ç¤º $D$ çš„å¤§å°. å¦‚æœå¯¹äº $t$ å’Œ $f$ æ²¡æœ‰æœ€å°å…¼å®¹é›†å­˜åœ¨ï¼Œå°±è®© $c[t,f]=+\infty$. æ³¨æ„ï¼Œ$G$ çš„æœ€å°æ”¯é…é›†å¤§å°å°±æ˜¯ $c[r,\emptyset]$. 

â€‹	å¯¹äºå­é›† $X\subseteq V(G)$ï¼Œè€ƒè™‘ä¸€ä¸ªæŸ“è‰²æ–¹æ¡ˆ $f:X_t\to \{0,\hat{0},1\}$. å¯¹äºèŠ‚ç‚¹ $v\in V(G)$ å’Œä¸€ä¸ªæŸ“è‰² $\alpha\in\{0,\hat{0},1\}$ï¼Œæˆ‘ä»¬æŒ‰ç…§ä¸‹é¢å»å®šä¹‰ä¸€ä¸ªæ–°çš„æŸ“è‰²æ–¹æ¡ˆ $f_{v\to\alpha}:X\cup\{v\}\to\{0,\hat{0},1\}$ï¼š
$$
f_{v\to\alpha}(x)=
\begin{cases}
f(x)&\text{when }x\neq v,\\
\alpha&\text{when }x=v.
\end{cases}
$$
ï¼ˆå°±æ˜¯æŠŠæŸ“è‰²æ–¹æ¡ˆ $f$ é‡Œçš„ $v$ çš„é¢œè‰²æ¢æˆ $\alpha$ï¼‰

å¯¹äº $X$ çš„ä¸€ä¸ªæŸ“è‰²æ–¹æ¡ˆ $f$ï¼Œ$Y\subseteq X$ï¼Œç”¨ $f\vert_Y$ æ¥è¡¨ç¤º $f$ å¯¹ $Y$ çš„é™åˆ¶.

ï¼ˆå°±æ˜¯ $f$ å¯¹ $Y$ æŸ“è‰²çš„éƒ¨åˆ†ï¼‰

***

â€‹	ä¸‹é¢æ¥è®¡ç®— $c$ çš„å€¼ï¼š

$\bold{Leaf\,\,node}$: å¯¹äºä¸€ä¸ª $leaf\,\,node$ $t$ï¼Œ$X_t=\emptyset$ï¼Œå› æ­¤ $c[t,\emptyset]=0$

$\bold{Introduce\,\,vertex\,\,node}$: $t$ æ˜¯ä¸€ä¸ª $introduce\,\,node$ï¼Œå…¶å­©å­èŠ‚ç‚¹ä¸º $t'$ï¼Œ$X_t=X_{t'}\cup\{v\}$ ä¸” $v\notin X_{t'}$. 
$$
c[t,f]=
\begin{cases}
+\infty&\text{when}\,\,f(v)=0,\\
c[t',f\vert_{X_{t'}}]&\text{when}\,\,f(v)=\hat{0},\\
1+c[t',f\vert_{X_{t'}}]&\text{when}\,\,f(v)=1.
\end{cases}
$$
â€‹	è§£é‡Šä¸€ä¸‹ $f(v)=0$ çš„æƒ…å†µï¼Œç”±äºè¯¥ç‚¹æ˜¯ $introduce\,\,node$ï¼Œè¿˜æ²¡æœ‰æ²¡æœ‰å¼•è¿›è¾¹ $uv$ åˆ°å›¾ $G_t$ é‡Œï¼Œå› æ­¤æ­¤æ—¶çš„ $v$ åœ¨å›¾ $G_t$ é‡Œæ˜¯å­¤ç«‹çš„ï¼Œåˆç”±äº $f(v)$ æ˜¯ç™½è‰²ï¼Œä½ æ²¡æ³•è®© $D$ åŒæ—¶æ»¡è¶³å…¼å®¹é›†çš„ä¸¤ä¸ªè¦æ±‚. æ‰€ä»¥å€¼ä¸º $+\infty$.

$\bold{Introduce\,\,edge\,\,node}$: $t$ æ˜¯ä¸€ä¸ª introduce edge nodeï¼Œæ ‡ç­¾ä¸º $uv$ï¼Œå…¶å­©å­èŠ‚ç‚¹ä¸º $t'$. $f$ ä¸º $X_t$ çš„ä¸€ç§æŸ“è‰²æ–¹æ¡ˆï¼Œ$D$ æ˜¯ $f$ å’Œ $t$ çš„æœ€å°
$$
c[t,f]=
\begin{cases}
c[t',f_{v\to\hat{0}}]&\text{when}\,\,(f(u),f(v))=(1,0),\\
c[t',f_{u\to\hat{0}}]&\text{when}\,\,(f(u),f(v))=(0,1),\\
c[t',f]&\text{otherwise}.
\end{cases}
$$
â€‹	æŒ‰ç€ä¸Šé¢å¯¹ $introduce\,\,vertex\,\,node$ çš„ä¸€ç‚¹è§£é‡Šå°±å®¹æ˜“ç†è§£ä¸€ç‚¹

$\bold{Forget\,\,node}$: $t$ æ˜¯ä¸€ä¸ª $forget\,\,node$ï¼Œå…¶å­©å­ä¸º $t'$ï¼Œ$X_t=X_{t'}\setminus\{v\}$ ä¸” $v\in X_{t'}$.
$$
c[t,f]=min\{c[t',f_{v\to 1}],c[t',f_{v\to 0}]\}
$$
$\bold{Join\,\,node}$: $t$ æ˜¯ä¸€ä¸ª $join\,\,node$ï¼Œå…¶å­©å­èŠ‚ç‚¹ $t_1$ å’Œ $t_2$ï¼Œ$X_t=X_{t_1}=X_{t_2}$ï¼ŒæŸ“è‰²æ–¹æ¡ˆ $f_1$ æ˜¯ $X_{t_1}$ çš„ï¼Œ$f_2$ åŒç†. æˆ‘ä»¬è¯´ $f_1$ å’Œ $f_2$ æ˜¯å¯¹ $f$ ä¸€è‡´çš„ï¼ˆ$consistent$ï¼‰ï¼Œå¦‚æœ $X_t$ é‡Œçš„æ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½æ»¡è¶³ä¸‹é¢æ¡ä»¶ï¼š

1. $f(v)=1$ if and only if $f_1(v)=f_2(v)=1$,
2. $f(v)=0$ if and only if $(f_1(v),f_2(v))\in\{(\hat{0},0),(0,\hat{0})\}$,
3. $f(v)=\hat{0}$ if and only if $f_1(v)=f_2(v)=\hat{0}$.

$$
c[t,f]=min_{f_1,f_2}\{c[t_1,f_1]+c[t_2,f_2]-|f^{-1}(1)|\}
$$

â€‹	ä¸Šé¢çš„ min æ˜¯å–æ‰€æœ‰å¯¹ $f$ ä¸€è‡´çš„ $f_1,f_2$.

â€‹	ä¸€æ–¹é¢ï¼Œå¦‚æœ $D$ æ˜¯å¯¹ $f$ å’Œ $t$ çš„å…¼å®¹é›†ï¼Œä¸”æœ‰ $f_1,f_2$ å¯¹ $f$ ä¸€è‡´ï¼Œé‚£ä¹ˆ $D_1:=D\cap V_{t_1}$ å°±æ˜¯å¯¹ $f_1$ å’Œ $t_1$ çš„å…¼å®¹é›†ï¼Œ$D_2:=D\cap V_{t_2}$ ä¸€æ ·. å³ï¼Œå¯¹ $f$ æŸ“è‰²é‡Œæ‰€æœ‰ç‚¹ $t$ æˆ‘ä»¬è®©å®ƒè¦ä¹ˆåœ¨ $f_1$ é‡Œæ˜¯ç™½è‰²çš„è¦ä¹ˆåœ¨ $f_2$ é‡Œç™½è‰²çš„ï¼Œå–å†³äº $v$ æ˜¯å¦åœ¨ $G_{t_1}$ é‡Œè¢« $D_1$ æ”¯é…æˆ–æ˜¯åœ¨ $G_{t_2}$ é‡Œè¢« $D_2$ æ”¯é…ï¼ˆå¦‚æœè¢«ä¸¤æ–¹é¢æ”¯é…ï¼Œé‚£ä»»æ„ä¸€ä¸ªé€‰æ‹©éƒ½æ˜¯åˆç†çš„ï¼‰. å¦ä¸€æ–¹é¢ï¼Œ å¦‚æœ $D_1$ æ˜¯å¯¹ $f_1$ å’Œ $t_1$ çš„å…¼å®¹é›†ï¼Œ$D_2$ åŒç†ï¼Œ$f_1,f_2$ å¯¹ $f$ ä¸€è‡´ï¼Œé‚£ä¹ˆå°±æœ‰ $D:=D_1\cup D_2$ æ˜¯å¯¹ $f$ å’Œ $t$ çš„å…¼å®¹é›†.

å¯¹äºè¿™æ ·çš„ $D_1$ å’Œ $D_2$ï¼Œæˆ‘ä»¬æœ‰ $D\cap X_t=D_1\cap X_{t_1}=D_2\cap X_{t_2}=f^{-1}(1)$ï¼Œäºæ˜¯æœ‰ |$D$| = |$D_1$| + |$D_2$| - |$f^{-1}(1)$|.

***

ä¸‹é¢ç®—ç®—æ—¶é—´ï¼š

å¯¹æ¯ä¸€ä¸ªçš„ leaf node, introduce vertex/edge node å’Œ forget node æ˜¯ $3^k$Â· $k^{O(1)}$ï¼Œè®¡ç®—æ¯ä¸€ä¸ª join node æ˜¯ $4^k$Â· $k^{O(1)}$ï¼Œç”±äºæˆ‘ä»¬å‡è®¾ä¸€ä¸ª $nice$ æ ‘åˆ†è§£çš„èŠ‚ç‚¹ä¸ªæ•°æ˜¯ $O(kn)$ï¼Œæˆ‘ä»¬æœ‰ä¸‹é¢ç»“è®ºï¼š

**Theorem 7.7** ç»™å®šä¸€ä¸ª $n$ ä¸ªèŠ‚ç‚¹çš„å›¾ $G$ å’Œå®ƒçš„å®½åº¦è‡³å¤šä¸º $k$  çš„æ ‘åˆ†è§£ï¼Œ$\bold{Dominating\,\,Set}$ é—®é¢˜å¯ä»¥åœ¨ $4^k$Â· $k^{O(1)}$Â· $n$ å†…å®Œæˆ.

åœ¨ç¬¬$11$ç« ä¼šä»‹ç»æŠŠ join node è®¡ç®—æ—¶é—´ä» $4^k$ é™åˆ° $3^k$.

## 7.3.3 Steiner Tree

â€‹	è¿™é‡Œäº†è§£[Steiner Tree](https://akejyo.github.io/blog/posts/2022/12/12/_6-1-dynamic-programming-over-subsets.html#steiner-tree). æˆ‘ä»¬ä¹Ÿä¼šå¯¹å›¾ $G$ åšä¸€ä¸ªå®½åº¦è‡³å¤šä¸º $k$ çš„ $nice$ æ ‘åˆ†è§£ï¼Œè¯¥æ ‘åˆ†è§£çš„å®šä¹‰æ–¹å¼å’Œ 7.3.2 é‡Œçš„ä¸€æ ·ï¼Œå³å¸¦æœ‰ $introduce\,\,edge\,\,nodes$.

> Single-exponential algorithm for Steiner Tree requires more advanced techniques that will be discussed in Chapter 11.

â€‹    ä¸ºäº†è®©æ¥ä¸‹æ¥çš„ç®—æ³•æ›´æ˜“è§£é‡Šï¼Œæˆ‘ä»¬éšæœºé€‰æ‹©ä¸€ä¸ªå…³é”®ç‚¹ $u^{*}\in K$ï¼Œå¹¶å°† $u^*$ æ·»åŠ åˆ°åœ¨ $\mathcal T$ é‡Œçš„æ¯ä¸€ä¸ªåŒ…é‡Œ. è¿™æ ·å¤„ç†å $\mathcal T$ çš„å®½åº¦å°†åŠ ä¸€ï¼Œæ ¹èŠ‚ç‚¹å’Œå¶å­èŠ‚ç‚¹éƒ½æ˜¯ $\{u^{*}\}$.

â€‹    åšä¸€äº›è§„å®šï¼š$H$ æ˜¯è¿æ¥äº† $K$ çš„æ–¯å¦çº³æ ‘ï¼Œ$t$ æ˜¯ $\mathcal T$ çš„èŠ‚ç‚¹. $H$ åœ¨ $G_t$ é‡Œçš„éƒ¨åˆ†æ˜¯ä¸€ä¸ªæœ‰äº›è®¸è¿é€šåˆ†é‡çš„æ£®æ— $F$.  ç”±äº $H$ æ˜¯è¿é€šçš„ä¸” $X_t$ è‡³å°‘åŒ…å«ä¸€ä¸ªå…³é”®ç‚¹ï¼Œå°±ä¼šæœ‰ $F$ é‡Œçš„æ¯ä¸€ä¸ªè¿é€šåˆ†é‡éƒ½å’Œ $X_t$ æœ‰äº¤é›†çš„. å¦å¤–ï¼Œ$K\cap V_t$ é‡Œçš„æ¯ä¸€ä¸ªå…³é”®ç‚¹éƒ½åº”è¯¥å±äº $F$ é‡Œçš„æŸäº›è¿é€šåˆ†é‡. å¯¹äº $X_t$ çš„æ¯ä¸€ä¸ªå­é›† $X$ å’Œ $X$ çš„æ¯ä¸€ä¸ªåˆ’åˆ† $\mathcal P$ï¼Œ$G_t$ é‡Œ $F$ çš„æœ€å°å¤§å°æœ‰ï¼š

1. $K\cap V_t\subseteq V(F)$ï¼Œå³ $F$ ç©¿è¿‡ $V_t$ é‡Œçš„æ‰€æœ‰å…³é”®ç‚¹ï¼Œ
2. $V(F)\cap X_t=X$,
3. $X_t$ ä¸ $F$ é‡Œè¿é€šåˆ†é‡èŠ‚ç‚¹é›†åˆçš„äº¤é›†æ­£å¥½å½¢æˆäº† $X$ çš„åˆ’åˆ† $\mathcal P$.

 <img :src="$withBase('/steinerTree1.png')">  

***

â€‹	å½“æˆ‘ä»¬å¼•å…¥æ–°èŠ‚ç‚¹æˆ–æ˜¯åœ¨ join node æ—¶ï¼Œéƒ¨åˆ†è§£çš„è¿é€šåˆ†é‡å¯èƒ½ä¼šåˆå¹¶ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å°†æ›´æ–°çš„åˆ†åŒºè·Ÿè¸ªåˆ°è¿é€šåˆ†é‡é‡Œ.

â€‹	è§„å®šï¼šå¯¹äºä¸€ä¸ªåŒ… $X_t$ï¼Œé›†åˆ $X\subseteq X_t$ï¼ˆå°±ä¸Šé¢é‚£ä¸ª Steiner treeå¯¼å‡ºæ¥çš„ï¼‰ï¼Œ$X$ çš„ä¸€ä¸ªåˆ’åˆ† $\mathcal P=\{P_1,P_2,...,P_q\}$ï¼Œ$c[t,X,\mathcal P]$ çš„å€¼å°±æ˜¯ $G_t$ é‡Œ $F$ çš„æœ€å°‘**è¾¹æ•°**ï¼Œä¸”ï¼š

* $F$ æœ‰æ°å¥½ $q$ ä¸ªè¿é€šåˆ†é‡ï¼Œåˆ†åˆ«ä¸º $C_1,...,C_q$ï¼Œå› æ­¤å¯¹äºæ¯ä¸€ä¸ª $s\in\{1,...,q\}$ï¼Œæœ‰ $P_s=V(C_s)\cap X_t$ï¼Œäºæ˜¯å°±æœ‰ $\mathcal P$ å’Œ $F$ çš„è¿é€šåˆ†é‡æ˜¯å¯¹åº”çš„.
* $X_t\cap V(F)=X$. å› æ­¤ $X_t\setminus X$ ä¸ $F$ ä¸ç›¸è¿.
* $K\cap V_t$ çš„æ¯ä¸€ä¸ªå…³é”®ç‚¹éƒ½åœ¨ $V(F)$ é‡Œ.

â€‹	å¦‚æœ $F$ ç¬¦åˆä¸Šé¢ï¼Œå°±è¯´ $F$ æ˜¯å¯¹ $(t,X,\mathcal P)$ å…¼å®¹çš„ï¼ˆ$compatible$ï¼‰ï¼Œå¦‚æœæ²¡æœ‰å…¼å®¹çš„ $F$ å­˜åœ¨ï¼Œå°±è®© $c[t,X,\mathcal P]=+\infty$

â€‹	æœ€ä¼˜è§£çš„ Steiner tree å³ä¸º $c[r,\{u^*\},\{\{u^*\}\}]$ï¼Œä¸‹é¢æ¥è®¡ç®— $c$.

***

$\bold{Leaf\,\, node}$: 	$t$ æ˜¯ leaf nodeï¼Œé‚£ä¹ˆ $X_t=\{u^*\}$. ç”±äº $u^*\in K$ï¼Œæˆ‘ä»¬æœ‰ $c[t,\emptyset,\emptyset]=+\infty$ï¼Œ$c[t,\{u^*\},\{\{u^*\}\}]=0$

$\bold{Introduce\,\,vertex\,\,node}$:  $t$ æ˜¯ introduce vertex nodeï¼Œå…¶å­©å­ $t'$ æœ‰ $X_t=X_{t'}\cup\{v\}$ï¼Œ$v\notin X_{t'}$. ç”±äºæˆ‘ä»¬è¿˜æ²¡æœ‰å¼•å…¥ä»»ä½•ä¸ $v$ ç›¸é‚»çš„è¾¹ï¼ˆè€ƒè™‘ introduce edge nodeï¼‰ï¼Œæ­¤æ—¶çš„ $v$ åœ¨ $G_t$ é‡Œæ˜¯å­¤ç«‹çš„. æ‰€ä»¥ï¼Œå¯¹æ¯ä¸€ä¸ªé›†åˆ $X\subseteq X_t$ å’Œ $X$ çš„åˆ’åˆ† $\mathcal{P}=\{P_1,P_2,...,P_q\}$ï¼Œæˆ‘ä»¬åšä»¥ä¸‹æ“ä½œï¼šå¦‚æœ $v$ æ˜¯ä¸€ä¸ªå…³é”®ç‚¹ï¼Œé‚£ä¹ˆå®ƒå¿…ç„¶æ˜¯å±äº $X$ çš„ï¼›å¦‚æœ $v$ æ˜¯å±äº $X$ çš„ï¼Œé‚£æœ‰ $\{v\}$ å°±æ˜¯ $\mathcal P$ çš„ä¸€ä¸ªè¿é€šåˆ†é‡. å¦‚æœä¸Šé¢çš„æƒ…å†µä¸èƒ½æ»¡è¶³ï¼Œé‚£ä¹ˆæˆ‘ä»¬è®© $c[t,X,\mathcal P]=+\infty$. å¦åˆ™ï¼š
$$
c[t,X,\mathcal P]=
\begin{cases}
c[t',X\setminus\{v\},\mathcal{P}\setminus\{\{v\}\}]&\text{it}\,\,v\in X,\\
c[t',X,\mathcal P]&\text{otherwise}.
\end{cases}
$$
$\bold{Introduce\,\,edge\,\,node}$: $t$ æ˜¯ä¸€ä¸ªå¼•å…¥äº†è¾¹ $uv$ çš„ introduce edge nodeï¼Œå…¶å­©å­ä¸º $t'$. å¯¹ä»»æ„çš„é›†åˆ $X\subseteq X_t$ å’Œ $X$ çš„åˆ’åˆ† $\mathcal P=\{P_1,P_2,...,P_q\}$ï¼Œæˆ‘ä»¬è€ƒè™‘ä»¥ä¸‹ä¸‰ç§æƒ…å†µï¼šå¦‚æœ  $u\notin X$ æˆ–è€… $v\notin X$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ä¸èƒ½æŠŠ $uv$ åŒ…å«è¿›æ­£åœ¨æ„å»ºçš„æ ‘é‡Œï¼ˆå› ä¸ºè¾¹çš„ä¸€ä¸ªç«¯ç‚¹ä¸ä¸æ ‘ç›¸è¿ï¼‰ï¼Œæ­¤æ—¶ $c[t,X,\mathcal P]=c[t',X,\mathcal P]$ï¼›åŒæ ·çš„ï¼Œå¦‚æœ $u$ å’Œ $v$ éƒ½åœ¨ $X$ é‡Œï¼Œä½†ä¸åœ¨ $\mathcal P$ çš„åŒä¸€å—é‡Œï¼Œç»“æœæ˜¯ä¸€æ ·çš„ï¼› å¦‚æœ $u$ å’Œ $v$ éƒ½åœ¨ $X$ é‡Œä¸”éƒ½åœ¨ $\mathcal P$ çš„åŒä¸€ä¸ªå—é‡Œï¼Œæ­¤æ—¶å¯ä»¥é€‰æ‹©æ˜¯å¦æ·»åŠ è¾¹ $uv$. å¦‚æœé€‰æ‹©ä¸æ·»åŠ  $uv$ï¼Œé‚£ä¹ˆå°±ç›´æ¥ $c[t,X,\mathcal P]=c[t',X,\mathcal P]$ï¼›å¦‚æœé€‰æ‹©æ·»åŠ  $uv$ï¼Œé‚£ä¹ˆåˆ’åˆ† $\mathcal{P}$ é‡ŒåŒ…å«äº† $u$ å’Œ $v$ é‚£ä¸ªå—å°±ä¸€å®šæ˜¯é€šè¿‡åˆå¹¶ä¸¤ä¸ªå°ä¸€ç‚¹çš„å—å¾—åˆ°çš„ï¼ˆä¸€ä¸ªåŒ…å«äº† $u$ ä¸€ä¸ªåŒ…å«äº† $v$ï¼‰. äºæ˜¯æœ‰ï¼š
$$
c[t,X,\mathcal P]=min\{min_{\mathcal{P'}}c[t',X,\mathcal{P'}]+1,c[t',X,\mathcal{P}]\}
$$


å…¶ä¸­å¤§æ‹¬å·é‡Œé¢é‚£ä¸ª minï¼Œæ˜¯æˆ‘ä»¬è€ƒè™‘ $X$ çš„æ‰€æœ‰ $u$ å’Œ $v$ ä¸åœ¨åŒä¸€ä¸ªå—é‡Œçš„åˆ’åˆ† $\mathcal{P'}$ï¼ˆå¦åˆ™æ·»åŠ  $uv$ å°†ä¼šå‡ºç°ç¯ï¼‰.

$\bold{Forget\,\,node}$: $t$ æ˜¯ä¸€ä¸ª forget nodeï¼Œå…¶å­©å­ $t'$ æœ‰ $X_t=X_{t'}\setminus\{v\}$ï¼Œ$v\in X_{t'}$. æ­¤æ—¶è¦åˆ† $v$ æ˜¯å¦åœ¨ $X$ å’Œ $\mathcal P$ å¯¹åº”çš„è§£å†³æ–¹æ¡ˆé‡Œ. å¦‚æœåœ¨ï¼Œé‚£ä¹ˆ $v$ å°±è¯¥æ·»åŠ åˆ° $\mathcal P$ å·²æœ‰çš„å—é‡Œï¼›å¦‚æœä¸åœ¨ï¼Œé‚£å°±å– $t'$ é‡Œä¸€æ ·çš„ $X$ å’Œ $\mathcal P$. å…·ä½“è§ä¸‹é¢å¼å­ï¼š
$$
c[t,X,\mathcal{P}]=min\{min_{\mathcal{P'}}c[t',X\cup\{v\},\mathcal{P'}],c[t',X,\mathcal{P}]\}
$$
å…¶ä¸­å¤§æ‹¬å·é‡Œé¢é‚£ä¸ª minï¼Œæ˜¯æˆ‘ä»¬å¯¹æ‰€æœ‰ $X\cup\{v\}$ çš„åˆ’åˆ† $\mathcal{P'}$ æ‰€å–çš„ï¼Œæ³¨æ„è¿™ä¸ª $\mathcal{P'}$ æ˜¯é€šè¿‡æŠŠ $v$ æ·»åŠ åˆ° $\mathcal P$ é‡Œçš„ä¸€ä¸ªå—è€Œå¾—åˆ°çš„.

$\bold{Join\,\,node}$: $t$ æ˜¯ä¸€ä¸ª join nodeï¼Œå…¶å­©å­å‘³ $t_1$ å’Œ $t_2$ï¼Œ$X_t=X_{t_1}=X_{t_2}$. å¤„ç†è¿™ç§ç‚¹å…¶å®å°±æ˜¯å»åˆå¹¶ $G_{t_1}$ å’Œ $G_{t_2}$ æ‰€å¯¹åº”çš„éƒ¨åˆ†è§£å†³æ–¹æ¡ˆï¼Œæ³¨æ„å¯èƒ½ä¼šå‡ºç°ç¯.

 <img :src="$withBase('/steinerTree2.png')">  

â€‹    ä¸ºäº†é¿å…åˆå¹¶æ—¶å‡ºç°ç¯ï¼Œæˆ‘ä»¬å°†ä»‹ç»ä¸€ç§ç»“æ„ï¼šå¯¹äº $X$ çš„ä¸€ä¸ªåˆ’åˆ† $\mathcal P$ï¼Œä»¤ $G_{\mathcal P}$ ä¸ºä¸€ä¸ªæ£®æ—ï¼Œå…¶ä¸­çš„è¿é€šåˆ†é‡æ°å¥½ä¸ $\mathcal P$ å¯¹åº”ï¼ˆå³ $\mathcal{P}$ é‡Œçš„æ¯ä¸€å—éƒ½æœ‰ $G_{\mathcal{P}}$ é‡Œçš„ä¸€ä¸ªæ ‘å’Œå…¶æœ‰ç›¸åŒçš„ç‚¹é›†ï¼‰.  å¦‚æœ $G_{\mathcal {P_1}}$ å’Œ $G_{\mathcal{P_2}}$ è¿™ä¸¤ä¸ªæ£®æ—åˆå¹¶åå¾—åˆ°çš„æ£®æ—é‡Œçš„è¿é€šåˆ†é‡æ°å¥½å°±æ˜¯ $\mathcal P$ ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¯´ $\mathcal P$ æ˜¯å¯¹ $\mathcal{P_1}$ å’Œ $\mathcal{P_2}$ çš„ä¸€ä¸ªæ— ç¯åˆå¹¶ï¼ˆ$acylic\,\,merge$ï¼‰. äºæ˜¯æœ‰ï¼š
$$
c[t,X,\mathcal P]=min_{\mathcal{P_1},\mathcal{P_2}}c[t_1,X,\mathcal{P_1}]+c[t_2,X,\mathcal{P_2}]
$$
è¿™é‡Œçš„ min æ˜¯å¯¹æ‰€æœ‰èƒ½æ»¡è¶³ $\mathcal P$ æ˜¯æ— ç¯åˆå¹¶çš„çš„ $\mathcal{P_1}$, $\mathcal{P_2}$ å¯¹æ‰€å–çš„.

ä¸‹é¢æ¥ä¼°è®¡è¿ç®—æ—¶é—´.

***

â€‹    é¦–å…ˆå›å¿†ä¸€ä¸‹ï¼Œæˆ‘ä»¬è¿™é‡Œæ ‘åˆ†è§£é‡Œçš„æ¯ä¸€ä¸ªåŒ…æœ€å¤§å¤§å°ä¸º $k+2$ï¼ˆå®½åº¦ä¸º $k+1$ äº†ï¼‰ï¼Œäºæ˜¯æ¯ä¸€ä¸ªèŠ‚ç‚¹çš„$c$ æƒ…å†µä¼šè‡³å¤šæœ‰ $2^{k+2}$ Â· $(k+2)^{k+2}=k^{O(k)}$ï¼ˆèŠ‚ç‚¹ $t$ æœ€å¤š $2^{|X_t|}$ ä¸ªå­é›† $X\subseteq X_t$ï¼Œè€Œ $X$ æœ€å¤š |$X$|$^{|X|}$ ä¸ªåˆ’åˆ†ï¼‰. è®¡ç®—ä¸€ä¸ª $c$ éœ€è¦æœ€å¤šè€ƒè™‘å…¶ä»–èŠ‚ç‚¹**å¯¹**çš„æ‰€æœ‰çŠ¶æ€ï¼Œéœ€è¦æ—¶é—´ $(k^{O(k)})^2=k^{O(k)}$. 

**Theorem 7.8.** ç»™å®š $n$ ä¸ªèŠ‚ç‚¹çš„å›¾ $G$ï¼Œ$K\subseteq V(G)$ ä¸ºç»™å®šçš„å…³é”®ç‚¹é›†åˆï¼ŒåŒæ—¶åˆç»™å®šå®½åº¦æœ€å¤šä¸º $k$ çš„æ ‘åˆ†è§£. é‚£ä¹ˆè®¡ç®—è¿æ¥ $K$ çš„ $Steiner\,\,tree$ çš„æœ€å°è¾¹æ•°éœ€è¦ $k^{O(k)}$ Â· $n$.

> Algorithms similar to the dynamic programming of Theorem 7.8 can be used to solve many problems in time $k^{O(k)}$ Â· $n^{O(1)}$. Essentially, such a running time appears for problems with connectivity requirements, since then it is natural to keep in the dynamic programming state a partition of a subset of the bag. Since the number of such partitions is at most $k^{O(k)}$, this factor appears naturally in the running time.

 <img :src="$withBase('/steinerTree3.png')">  

> The main challenge for most of the problems is to understand what information to store at nodes of the tree decomposition. Obtaining formulas for forget, introduce and join nodes can be a tedious task, but is usually straightforward once a precise definition of a state is established.

